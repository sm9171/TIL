<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Singleton 패턴 | 나상민의 TIL</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="생각 정리">
    
    <link rel="preload" href="/TIL/assets/css/0.styles.dd5ac3b9.css" as="style"><link rel="preload" href="/TIL/assets/js/app.552d5468.js" as="script"><link rel="preload" href="/TIL/assets/js/2.99089f8b.js" as="script"><link rel="preload" href="/TIL/assets/js/10.99cc811c.js" as="script"><link rel="prefetch" href="/TIL/assets/js/11.ff56b2bb.js"><link rel="prefetch" href="/TIL/assets/js/12.6f8f06d4.js"><link rel="prefetch" href="/TIL/assets/js/13.86903d7a.js"><link rel="prefetch" href="/TIL/assets/js/14.6a285c2c.js"><link rel="prefetch" href="/TIL/assets/js/15.c782545e.js"><link rel="prefetch" href="/TIL/assets/js/16.26e618aa.js"><link rel="prefetch" href="/TIL/assets/js/17.c38a942d.js"><link rel="prefetch" href="/TIL/assets/js/18.bd0636bf.js"><link rel="prefetch" href="/TIL/assets/js/19.77d987ed.js"><link rel="prefetch" href="/TIL/assets/js/20.59fd4a95.js"><link rel="prefetch" href="/TIL/assets/js/21.af269ebb.js"><link rel="prefetch" href="/TIL/assets/js/22.8b910137.js"><link rel="prefetch" href="/TIL/assets/js/23.52af7a9c.js"><link rel="prefetch" href="/TIL/assets/js/3.6d70358d.js"><link rel="prefetch" href="/TIL/assets/js/4.449a2c8e.js"><link rel="prefetch" href="/TIL/assets/js/5.7329d13e.js"><link rel="prefetch" href="/TIL/assets/js/6.a667c83e.js"><link rel="prefetch" href="/TIL/assets/js/7.5fcb7a80.js"><link rel="prefetch" href="/TIL/assets/js/8.c8b96b86.js"><link rel="prefetch" href="/TIL/assets/js/9.5790487b.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.dd5ac3b9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><img src="https://avatars1.githubusercontent.com/u/18749057?s=460&amp;v=4" alt="나상민의 TIL" class="logo"> <span class="site-name can-hide">나상민의 TIL</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/TIL/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://github.com/sm9171/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://naccoon.tistory.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/TIL/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://github.com/sm9171/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://naccoon.tistory.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Monthly I Learned</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Books</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Principle</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/Principle/DesignPattern.html" aria-current="page" class="active sidebar-link">Singleton 패턴</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/Principle/DesignPattern.html#정의" class="sidebar-link">정의</a></li><li class="sidebar-sub-header"><a href="/TIL/Principle/DesignPattern.html#구현" class="sidebar-link">구현</a></li><li class="sidebar-sub-header"><a href="/TIL/Principle/DesignPattern.html#싱글턴의-단점" class="sidebar-link">싱글턴의 단점</a></li><li class="sidebar-sub-header"><a href="/TIL/Principle/DesignPattern.html#command-패턴의-구성" class="sidebar-link">Command 패턴의 구성</a></li><li class="sidebar-sub-header"><a href="/TIL/Principle/DesignPattern.html#command-패턴의-장점" class="sidebar-link">Command 패턴의 장점</a></li><li class="sidebar-sub-header"><a href="/TIL/Principle/DesignPattern.html#command-패턴의-단점" class="sidebar-link">Command 패턴의 단점</a></li><li class="sidebar-sub-header"><a href="/TIL/Principle/DesignPattern.html#전략패턴과-커멘드-패턴의-차이점" class="sidebar-link">전략패턴과 커멘드 패턴의 차이점</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="singleton-패턴"><a href="#singleton-패턴" class="header-anchor">#</a> Singleton 패턴</h1> <h2 id="정의"><a href="#정의" class="header-anchor">#</a> 정의</h2> <ul><li>싱글턴(singleton)은 오직 하나의 객체만을 생성할 수 있는 클래스를 말합니다. 따라서 싱글턴 패턴을 사용하면 쉽게 객체의 유일성을 보장할 수 있습니다.</li> <li>또한 일반적으로 싱글턴 객체에 대한 참조를 public static 필드나 public static 메서드로 노출하므로 어디에서나 싱글턴 객체에 접근할 수 있습니다.</li></ul> <h2 id="구현"><a href="#구현" class="header-anchor">#</a> 구현</h2> <h3 id="싱글턴객체-기본-생성법"><a href="#싱글턴객체-기본-생성법" class="header-anchor">#</a> 싱글턴객체 기본 생성법</h3> <ul><li>public static final을 이용하여 외부에서 자유롭게 접근이 가능하지만 이 필드에 다른 객체가 할당되거나, 이미 할당했는데 싱글턴 내부에서 다시 객체를 할당하는 실수가 없도록 해야됨.</li> <li>그리고 외부에서 생성자를 통해 객체를 생성할 수 없도록 생성자 접근을 private으로 제한</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Singleton</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
 
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

<span class="token comment">// 혹은 ...</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Singleton</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
 
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
 
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>다음과 같이 정적필드로 접근 가능</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 생성자의 접근 범위가 private이기 때문에 생성자로는 객체를 생성할 수 없다.</span>
<span class="token comment">// Singleton obj = new Singleton(); (X)</span>
 
<span class="token comment">// INSTANCE는 final로 선언되었기 때문에 외부에서 다시 지정하는 것은 불가능하다.</span>
<span class="token comment">// Singleton.INSTANCE = null; (X)</span>
 
<span class="token comment">// 외부에서 정적 필드로 다음과 같이 접근할 수 있다.</span>
<span class="token class-name">Singleton</span><span class="token punctuation">.</span>INSTANCE<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// 혹은...</span>
<span class="token class-name">Singleton</span> obj <span class="token operator">=</span> <span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">service</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="지연초기"><a href="#지연초기" class="header-anchor">#</a> 지연초기</h3> <ul><li>싱글턴 인스턴스를 초기화할때 다음과 같이 지연초기화를 이용하여 처음 한번만 초기화 가능하게 할 수 있다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> instance<span class="token punctuation">;</span>  
  
    <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre></div><ul><li>멀티쓰레드 환경에서 원자성을 위배할 수 있기 때문에 synchronized를 붙여 한번의 하나의 스레드만 접근가능하도록 동기화 하어야 한다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>  
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> instance<span class="token punctuation">;</span>  
  
    <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>  
  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre></div><ul><li>더블 체크 락킹을 이용하여 동기화 범위를 줄여 동기화 오버헤드를 줄일 수 있다. 여기서 중요한 점은 instance 필드에 값을 쓸 때 재배열이 일어나지 않도록 volatile로 선언하는 것입니다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">volatile</span> <span class="token class-name">Singleton</span> instance<span class="token punctuation">;</span>
  
    <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>  
 
	<span class="token comment">// 코드가 다소 장황하지만 동기화 오버헤드를 피할 수 있으므로 성능 이점이 있다.</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 동기화 블록은 한번에 하나의 스레드만 접근할 수 있다.</span>
			<span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> instance<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
 
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>요청 시 초기화 홀더 패턴을 이용하여 간단하게 구현할 수도 있다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>  
 
    <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Holder</span> <span class="token punctuation">{</span>  
        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Singleton</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
    
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token class-name">Holder</span><span class="token punctuation">.</span>INSTANCE<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>
 
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="싱글턴의-단점"><a href="#싱글턴의-단점" class="header-anchor">#</a> 싱글턴의 단점</h2> <ol><li>테스트하기가 어렵다</li></ol> <ul><li>테스트는 독립적, 즉 다른 테스트에 영향을 미치지 않아야 하는데 한 테스트에서 싱글턴 객체가 만들어지면 그 이후의 다른 테스트에서도 이를 확인할 수 있다.</li> <li>또한 일반적으로 인터페이스가 아닌 클래스를 통해 구현되는 싱글턴은 목(mock)으로 대체할 수 없으므로 단위 테스트를 매우 까다롭게 만든다.</li> <li>이를 해결하기 위해서 주로 의존관계 주입(dependency injection, 이하 DI)을 사용할 수 있으며 이때는 보통 DI 프레임워크가 싱글턴 객체의 생성을 제어한다.</li></ul> <ol start="2"><li>데이터 경쟁이 일어나기 쉽다</li></ol> <ul><li>싱글턴이 상태를 가지고 있다면 상황이 더 복잡해지며, 멀티 스레드 환경에서는 공유 변수 접근 시 적절하게 동기화가 이루어지지 않았다면 경쟁 상태(race condition)가 문제가 될 수 있으므로 주의해야 합니다.</li></ul> <ol start="3"><li>변경에 취약해진다</li></ol> <h1 id="command-패턴"><a href="#command-패턴" class="header-anchor">#</a> Command 패턴</h1> <p>커맨드 패턴(Command pattern)은 객체가 특정 기능을 바로 수행하거나 나중에 트리거할 때 필요한 모든 정보를 캡슐화하는 행동 패턴이다.
이렇게 하면, 나중에 순서대로 실행하기 위한 명령 목록을 구성하거나 되돌리기가 가능한 명령을 만드는 등이 가능하다. 커맨드 패턴이 캡슐화하는 정보는 다음과 같다.</p> <ul><li>메서드명</li> <li>메서드를 소유하는 객체</li> <li>메서드 인자(parameter)</li></ul> <h2 id="command-패턴의-구성"><a href="#command-패턴의-구성" class="header-anchor">#</a> Command 패턴의 구성</h2> <p><img src="/TIL/assets/img/command_pattern.77a1641a.png" alt="command_pattern.png">
Invoker 클래스는 Command 인터페이스를 가진 객체의 execute() 메서드를 호출한다.
사실 이는 ConcreteCommand 클래스의 객체로, execute() 메서드는 실제 작업을 하는 Receiver 클래스의 객체를 호출한다.</p> <ul><li>Invoker: 명령이 들어 있으며, execute() 메서드를 호출함으로써 ConcreteCommand 객체에게 특정 작업의 수행을 요청한다.</li> <li>Receiver: 요구 사항을 수행하기 위해 어떤 일을 처리해야 하는지 알고 있는 객체다.</li> <li>Command: 연산을 수행할 인터페이스를 정의한다. 모든 커맨드 객체는 이 인터페이스를 구현해야 하며, 모든 명령은 execute() 메서드 호출을 통해 수행된다. 이 메서드에서는 Receiver에 특정 작업을 처리하라는 지시를 전달한다.</li> <li>ConcreteCommand: 이 클래스는 Command 인터페이스를 확장하고, execute() 메서드를 구현함으로써 Receiver에 있는 메서드를 호출하여 요청된 작업을 수행한다.</li></ul> <h2 id="command-패턴의-장점"><a href="#command-패턴의-장점" class="header-anchor">#</a> Command 패턴의 장점</h2> <ul><li>작업을 요청하는 클래스와 실제로 작업을 수행하는 클래스를 분리한다.</li> <li>기존 코드를 수정하지 않고 새로운 커맨드를 쉽게 추가할 수 있다.</li> <li>정보 시스템의 일반적인 특성은 트랜잭션(transaction)을 처리해야 한다는 것이다. 트랜잭션은 일련의 과정을 통해 데이터를 변경하는 것인데, 커맨드 패턴은 이런 트랜잭션의 모델링을 가능하게 한다</li></ul> <h2 id="command-패턴의-단점"><a href="#command-패턴의-단점" class="header-anchor">#</a> Command 패턴의 단점</h2> <ul><li>모든 작업이 독립적인 ConcreteCommand 클래스이므로 구현 및 유지보수해야 하는 클래스가 많다.</li> <li>단 하나의 커맨드에 대해 클래스가 많아진다.</li></ul> <h1 id="strategy-패턴"><a href="#strategy-패턴" class="header-anchor">#</a> Strategy 패턴</h1> <p>객체들이 할 수 있는 행위 각각에 대해 전략 클래스를 생성하고, 유사한 행위들을 캡슐화 하는 인터페이스를 정의하여,
객체의 행위를 동적으로 바꾸고 싶은 경우 직접 행위를 수정하지 않고 전략을 바꿔주기만 함으로써 행위를 유연하게 확장하는 방법을 말합니다.</p> <h2 id="전략패턴과-커멘드-패턴의-차이점"><a href="#전략패턴과-커멘드-패턴의-차이점" class="header-anchor">#</a> 전략패턴과 커멘드 패턴의 차이점</h2> <h3 id="전략패턴-예시"><a href="#전략패턴-예시" class="header-anchor">#</a> 전략패턴 예시</h3> <p>전략 패턴은 프로그램이 진행되면서 캡슐화된 로직을 선택할 수 있게 하는 디자인 패턴입니다. 로직 실행은 인터페이스에 의존을 시키고 인터페이스를 구현한 로직들을 전달해줌으로써 분기처리 없이 유연성을 갖출 수가 있습니다</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PeopleWithMovement</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Transportation</span> transportation<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">PeopleWithMovement</span><span class="token punctuation">(</span><span class="token class-name">Transportation</span> transportation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>transportation <span class="token operator">=</span> transportation<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token class-name">String</span> start<span class="token punctuation">,</span> <span class="token class-name">String</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        transportation<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">changeTransporation</span><span class="token punctuation">(</span><span class="token class-name">Transportation</span> transportation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>transportation <span class="token operator">=</span> transportation<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Transportation</span> <span class="token punctuation">{</span>

    <span class="token keyword">void</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token class-name">String</span> start<span class="token punctuation">,</span> <span class="token class-name">String</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Bicycle</span> <span class="token keyword">implements</span> <span class="token class-name">Transportation</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token class-name">String</span> start<span class="token punctuation">,</span> <span class="token class-name">String</span> end<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;출발점 : &quot;</span> <span class="token operator">+</span> start <span class="token operator">+</span> <span class="token string">&quot;에서 목적지 : &quot;</span> <span class="token operator">+</span> end <span class="token operator">+</span> <span class="token string">&quot;까지 `자전거`로 이동합니다.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Bus</span> <span class="token keyword">implements</span> <span class="token class-name">Transportation</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token class-name">String</span> start<span class="token punctuation">,</span> <span class="token class-name">String</span> end<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;출발점 : &quot;</span> <span class="token operator">+</span> start <span class="token operator">+</span> <span class="token string">&quot;에서 목적지 : &quot;</span> <span class="token operator">+</span> end <span class="token operator">+</span> <span class="token string">&quot;까지 `버스`로 이동합니다.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Bicycle</span> bicycle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bicycle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Bus</span> bus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">PeopleWithMovement</span> whybeFirst <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PeopleWithMovement</span><span class="token punctuation">(</span>bicycle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        whybeFirst<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token string">&quot;시작점&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;끝점&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">PeopleWithMovement</span> whybeSecond <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PeopleWithMovement</span><span class="token punctuation">(</span>bus<span class="token punctuation">)</span><span class="token punctuation">;</span>
        whybeSecond<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token string">&quot;시작점&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;끝점&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">PeopleWithMovement</span> whybeChangeMovement <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PeopleWithMovement</span><span class="token punctuation">(</span>bicycle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        whybeChangeMovement<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token string">&quot;시작점&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;중간지점&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        whybeChangeMovement<span class="token punctuation">.</span><span class="token function">changeTransporation</span><span class="token punctuation">(</span>bus<span class="token punctuation">)</span><span class="token punctuation">;</span>
        whybeChangeMovement<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token string">&quot;중간지점&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;끝점&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><ul><li>출발점 : 시작점에서 목적지 : 끝점까지 <code>자전거</code>로 이동합니다.</li> <li>출발점 : 시작점에서 목적지 : 끝점까지 <code>버스</code>로 이동합니다.</li> <li>출발점 : 시작점에서 목적지 : 중간지점까지 <code>자전거</code>로 이동합니다.</li> <li>출발점 : 중간지점에서 목적지 : 끝점까지 <code>버스</code>로 이동합니다.</li></ul></blockquote> <h3 id="커멘드패턴-예시"><a href="#커멘드패턴-예시" class="header-anchor">#</a> 커멘드패턴 예시</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PeopleWithLottery</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LotteryCommand</span><span class="token punctuation">&gt;</span></span> lotteryCommands<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">PeopleWithLottery</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LotteryCommand</span><span class="token punctuation">&gt;</span></span> lotteryCommands<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lotteryCommands <span class="token operator">=</span> lotteryCommands<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addLotteryCommand</span><span class="token punctuation">(</span><span class="token class-name">LotteryCommand</span> lotteryCommand<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lotteryCommands<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>lotteryCommand<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">scratchAllLottery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lotteryCommands<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">LotteryCommand</span> lotteryCommand <span class="token operator">=</span> lotteryCommands<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            lotteryCommand<span class="token punctuation">.</span><span class="token function">scratch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//초기화</span>
        lotteryCommands <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">LotteryCommand</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">scratch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InstantScratch</span> <span class="token keyword">implements</span> <span class="token class-name">LotteryCommand</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token class-name">InstantLottery</span> instantLottery<span class="token punctuation">;</span>
    <span class="token keyword">private</span> account <span class="token class-name">Account</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">InstantScratch</span><span class="token punctuation">(</span><span class="token class-name">InstantLottery</span> instantLottery<span class="token punctuation">,</span> <span class="token class-name">Account</span> account<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>instantLottery <span class="token operator">=</span> instantLottery<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>account <span class="token operator">=</span> <span class="token class-name">Account</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">scratch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//instantLottery의 당첨을 확인하고 account에 돈을 집어 넣는 로직</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InstantLottery</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> win<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">InstantLottery</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> win<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>win <span class="token operator">=</span> win<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isWin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> win<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> balance<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">putMoney</span><span class="token punctuation">(</span><span class="token keyword">int</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        balance <span class="token operator">+=</span> money<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">PeopleWithLottery</span> whybe <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PeopleWithLottery</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Account</span> 와이비통장 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Account</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//즉석복권 구입</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//즉석복권 생성 로직 </span>
            <span class="token class-name">InstantLottery</span> instantLottery <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InstantLottery</span><span class="token punctuation">(</span>당첨여부<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//즉석복권긁기행위 객체 생성 및 커맨드 목록에 추가</span>
            <span class="token class-name">InstantScratch</span> 즉석복권긁기커맨드 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InstantScratch</span><span class="token punctuation">(</span>즉석복권<span class="token punctuation">,</span> 와이비통장<span class="token punctuation">)</span><span class="token punctuation">;</span>
            whybe<span class="token punctuation">.</span><span class="token function">addLotteryCommand</span><span class="token punctuation">(</span>즉석복권긁기커맨드<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        whybe<span class="token punctuation">.</span><span class="token function">scratchAllLotery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="전략패턴과-커맨드패턴의-차이점"><a href="#전략패턴과-커맨드패턴의-차이점" class="header-anchor">#</a> 전략패턴과 커맨드패턴의 차이점</h3> <p>전략 패턴은 먼저 <code>어떻게</code> 라는 측면에 집중하게 됩니다. 하고자 하는 것은 이미 정해져 있고, 방법을 어떻게 할지에 대한 유연성을 고려하며 구현합니다. 인터페이스의 메소드에 직접적으로 의존을 하게 되어서, 해당 메소드의 parameter들에 강하게 영향을 받습니다. 이 때문에 위의 복권예시같은 로직을 수행하여 다른 인자가 필요하게 된다면 오버로딩을 해주어야하는데, 전략 패턴의 가치가 퇴색이 될 것입니다.</p> <p>하지만 커맨드 패턴은 <code>무엇을</code> 초점을 두게 됩니다. 어떻게 할지에 대한 방법은 외부에서 정의하며 주입을 해주며, 그것을 실행하는 것이 중요하기 때문입니다. 그래서 즉석 복권 혹은 번호식 복권 중 무엇을 긁을지에 대해서 구현할 때에는 전략 패턴보다는 커맨드 패턴이 조금 더 적합하다고 볼 수가 있습니다.</p> <p>위의 예시에서는 커맨드 패턴은</p> <ol><li>무엇을 할지를 선택하면 해당 행위를 하기 위한 필요한 변수들을 같이 캡슐화하여 제공받기 때문에 유연하다.</li> <li>Receiver(Account)도 같이 제공을 받기 때문에 행위에 따른 영향을 받는 객체도 조건에 따라 다르게 설정할 수 있다.</li></ol> <p>의 장점을 알 수가 있습니다.</p> <h1 id="state-패턴"><a href="#state-패턴" class="header-anchor">#</a> State 패턴</h1> <h1 id="adapter-패턴"><a href="#adapter-패턴" class="header-anchor">#</a> Adapter 패턴</h1> <h1 id="proxy-패턴"><a href="#proxy-패턴" class="header-anchor">#</a> Proxy 패턴</h1> <h1 id="facade-패턴"><a href="#facade-패턴" class="header-anchor">#</a> Facade 패턴</h1> <h1 id="template-method-패턴"><a href="#template-method-패턴" class="header-anchor">#</a> Template Method 패턴</h1> <h1 id="decorator-패턴"><a href="#decorator-패턴" class="header-anchor">#</a> Decorator 패턴</h1> <h1 id="factory-method-패턴"><a href="#factory-method-패턴" class="header-anchor">#</a> Factory Method 패턴</h1> <h1 id="abstract-factory-패턴"><a href="#abstract-factory-패턴" class="header-anchor">#</a> Abstract Factory 패턴</h1> <h1 id="mediator-패턴"><a href="#mediator-패턴" class="header-anchor">#</a> Mediator 패턴</h1> <h1 id="composite-패턴"><a href="#composite-패턴" class="header-anchor">#</a> Composite 패턴</h1></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/Books/Clean Code.html" class="prev">
        Clean Code-Rovert C.Martin
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/TIL/assets/js/app.552d5468.js" defer></script><script src="/TIL/assets/js/2.99089f8b.js" defer></script><script src="/TIL/assets/js/10.99cc811c.js" defer></script>
  </body>
</html>
